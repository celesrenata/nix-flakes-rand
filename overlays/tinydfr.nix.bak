final: prev:
rec {
  tiny-dfr = prev.rustPlatform.buildRustPackage rec {
    pname = "tiny-dfr";
    version = "0.3.0";

    src = prev.fetchFromGitHub {
      owner = "WhatAmISupposedToPutHere";
      repo = "tiny-dfr";
      rev = "6f957fdd246452b14d1f787c2630d0a500f082e7";
      sha256 = "sha256-l4D7aePz/CYpkRorrvsgIYrvSzoZs59OGcFGJqqJftk=";
    };

    cargoHash = "sha256-QOkztErJLFXPxCb8MvaXi7jGXeI3A0q8LwZtYddzUZE=";
   
    patches = [
      ../patches/tiny-dfr.patch
    ];

    nativeBuildInputs = with prev.pkgs; [
      pkg-config
    ];

    buildInputs = with prev.pkgs; [
      systemd
      glib
      pango
      gdk-pixbuf
      libxml2
      libinput
    ];

    installPhase = ''
      ls -R
      install -m755 -D target/x86_64-unknown-linux-gnu/release/tiny-dfr $out/bin/tiny-dfr
    '';
  };
}
